<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üéÅ –ö–û–†–û–ë–û–ß–ö–ê 3.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Caveat', cursive, sans-serif;
            background-color: #f5f5f5;
            background-image: 
                linear-gradient(rgba(200, 200, 200, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(200, 200, 200, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            color: #333;
            padding: 10px;
            line-height: 1.4;
            font-size: 16px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 15px;
            padding-top: 5px;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: #5d4037;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.1);
        }

        .sections {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 15px;
        }

        .section {
            width: 100%;
            padding: 20px 12px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background-color: rgba(0, 0, 0, 0.15);
        }

        .section:active {
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        }

        .section h2 {
            margin-bottom: 8px;
            font-size: 1.3rem;
            text-align: center;
            line-height: 1.2;
        }

        .section p {
            text-align: center;
            font-size: 1rem;
        }

        .mandatory {
            background-color: #fff9c4; /* –∂–µ–ª—Ç—ã–π */
        }

        .security {
            background-color: #bbdefb; /* –≥–æ–ª—É–±–æ–π */
        }

        .joys {
            background-color: #c8e6c9; /* –∑–µ–ª–µ–Ω—ã–π */
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        button, select, input, textarea {
            font-family: 'Caveat', cursive;
            font-size: 1.1rem;
        }

        button {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            background-color: #5d4037;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            min-height: 44px;
        }

        button:active {
            background-color: #7b5e57;
            transform: scale(0.98);
        }

        .task-list {
            background-color: white;
            border-radius: 8px;
            padding: 15px 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .task-list h2 {
            margin-bottom: 12px;
            font-size: 1.4rem;
            color: #5d4037;
            text-align: center;
        }

        .task-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        textarea, select, input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            width: 100%;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .tasks {
            margin-top: 15px;
        }

        .task {
            padding: 10px 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.3s;
        }

        .task-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
        }

        .task-text {
            font-size: 1.1rem;
            word-break: break-word;
            flex: 1;
            padding-right: 8px;
            line-height: 1.3;
        }

        .task-controls {
            display: flex;
            gap: 6px;
            align-items: center;
            margin-top: 8px;
            justify-content: flex-end;
            width: 100%;
        }

        .task-control-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 6px;
            border-radius: 4px;
            min-height: auto;
            color: #5d4037;
            box-shadow: none;
            transition: all 0.3s;
        }

        .task-control-btn:active {
            background-color: rgba(0, 0, 0, 0.1);
            transform: scale(0.95);
        }

        .category-0 { 
            background-color: #f5f5f5; 
            border-left: 4px solid #9E9E9E;
        }
        .category-1 { 
            background-color: #fff9c4; 
            border-left: 4px solid #FFD54F;
        }
        .category-2 { 
            background-color: #bbdefb; 
            border-left: 4px solid #64B5F6;
        }
        .category-3 { 
            background-color: #c8e6c9; 
            border-left: 4px solid #81C784;
        }
        .category-4 { 
            background-color: #ffcdd2; 
            border-left: 4px solid #E57373;
        }
        .category-5 { 
            background-color: #d1c4e9; 
            border-left: 4px solid #9575CD;
        }

        .inactive {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .category-selector {
            position: relative;
            display: inline-block;
            z-index: 1;
        }

        .category-badge {
            font-size: 0.85rem;
            padding: 3px 8px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.1);
            margin: 0 3px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .category-badge:active {
            background-color: rgba(0, 0, 0, 0.2);
            transform: scale(0.95);
        }

        .category-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 6px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
            padding: 8px;
            z-index: 1000;
            display: none;
            min-width: 130px;
        }

        .category-dropdown.show {
            display: block;
        }

        .category-option {
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 4px;
            width: 100%;
            text-align: left;
            font-family: 'Caveat', cursive;
            font-size: 1rem;
            transition: all 0.3s;
            color: #333;
        }

        .category-option:active {
            transform: scale(0.98);
        }

        .category-option:last-child {
            margin-bottom: 0;
        }

        /* –¶–≤–µ—Ç–∞ –¥–ª—è –æ–ø—Ü–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
        .category-option[data-category="0"] {
            background-color: #f5f5f5;
            border-left: 2px solid #9E9E9E;
        }
        
        .category-option[data-category="1"] {
            background-color: #fff9c4;
            border-left: 2px solid #FFD54F;
        }
        
        .category-option[data-category="2"] {
            background-color: #bbdefb;
            border-left: 2px solid #64B5F6;
        }
        
        .category-option[data-category="3"] {
            background-color: #c8e6c9;
            border-left: 2px solid #81C784;
        }
        
        .category-option[data-category="4"] {
            background-color: #ffcdd2;
            border-left: 2px solid #E57373;
        }
        
        .category-option[data-category="5"] {
            background-color: #d1c4e9;
            border-left: 2px solid #9575CD;
        }

        .timer-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.98);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 15px;
            overflow-y: auto;
        }

        .timer-content {
            text-align: center;
            width: 100%;
            max-width: 350px;
            padding: 20px 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.2);
        }

        .timer-display {
            font-size: 2.5rem;
            margin: 15px 0;
            font-weight: bold;
            color: #5d4037;
        }

        .timer-task {
            font-size: 1.3rem;
            margin-bottom: 20px;
            padding: 12px;
            border-radius: 6px;
            background-color: #f5f5f5;
            word-break: break-word;
            line-height: 1.3;
        }

        .timer-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        .timer-btn {
            padding: 10px 15px;
            font-size: 1.1rem;
            min-height: 40px;
            transition: all 0.3s;
        }

        /* –ù–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ç–∞–π–º–µ—Ä–∞ */
        #startTimerBtn {
            background-color: #9CCC65; /* –∂–µ–ª—Ç–æ-–∑–µ–ª–µ–Ω—ã–π */
        }
        
        #startTimerBtn:active {
            background-color: #8BC34A;
        }

        #pauseTimerBtn {
            background-color: #ff9800; /* –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
        }
        
        #pauseTimerBtn:active {
            background-color: #e68a00;
        }

        #resetTimerBtn {
            background-color: #f44336; /* –∫—Ä–∞—Å–Ω—ã–π */
        }
        
        #resetTimerBtn:active {
            background-color: #d32f2f;
        }

        #completeTaskBtn {
            background-color: #388E3C; /* —Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π */
        }
        
        #completeTaskBtn:active {
            background-color: #2E7D32;
        }

        #returnTaskBtn {
            background-color: #795548; /* –∫–æ—Ä–∏—á–Ω–µ–≤—ã–π */
        }
        
        #returnTaskBtn:active {
            background-color: #5D4037;
        }

        #closeTimerBtn {
            background-color: #9E9E9E; /* —Å–µ—Ä—ã–π */
        }
        
        #closeTimerBtn:active {
            background-color: #757575;
        }

        #timerMinutes {
            text-align: center;
            font-size: 1.1rem;
            padding: 8px;
        }

        .import-export {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: block;
            padding: 10px;
            background-color: #5d4037;
            color: white;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            font-size: 1rem;
        }

        .notification {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #5d4037;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            font-size: 1.1rem;
        }

        .timer-complete-options {
            display: none;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ –∏ –±–æ–ª—å—à–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ */
        @media (min-width: 480px) {
            body {
                padding: 15px;
                font-size: 18px;
            }
            
            .section {
                padding: 25px 15px 20px;
            }
            
            .timer-controls {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .timer-btn {
                flex: 1;
                min-width: 100px;
            }

            .import-export {
                flex-direction: row;
            }
            
            .task {
                flex-direction: row;
                align-items: center;
            }
            
            .task-controls {
                margin-top: 0;
                width: auto;
                justify-content: flex-end;
            }
        }

        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö –Ω–æ—É—Ç–±—É–∫–æ–≤ */
        @media (min-width: 768px) {
            .sections {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .section {
                flex: 1;
                min-width: 220px;
                max-width: calc(50% - 8px);
            }
            
            .controls {
                flex-direction: row;
            }
            
            button {
                flex: 1;
            }
        }

        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤ */
        @media (min-width: 1024px) {
            .container {
                max-width: 1000px;
            }
            
            .section {
                max-width: calc(33.333% - 10px);
            }
            
            .section:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }
            
            button:hover {
                background-color: #7b5e57;
            }
            
            .task-control-btn:hover {
                background-color: rgba(0, 0, 0, 0.1);
            }
            
            .category-badge:hover {
                background-color: rgba(0, 0, 0, 0.2);
            }
            
            .category-option:hover {
                transform: translateX(3px);
            }
            
            #startTimerBtn:hover {
                background-color: #8BC34A;
            }
            
            #pauseTimerBtn:hover {
                background-color: #e68a00;
            }
            
            #resetTimerBtn:hover {
                background-color: #d32f2f;
            }
            
            #completeTaskBtn:hover {
                background-color: #2E7D32;
            }
            
            #returnTaskBtn:hover {
                background-color: #5D4037;
            }
            
            #closeTimerBtn:hover {
                background-color: #757575;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÅ –ö–û–†–û–ë–û–ß–ö–ê 3.0</h1>
        </header>
        
        <div class="sections">
            <div class="section mandatory" data-category="1">
                <h2>–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–ª–∞</h2>
                <p>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∑–∞–¥–∞—á—É</p>
            </div>
            
            <div class="section security" data-category="2,5">
                <h2>–°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ <br>–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—ã—Ö —Ä–∞–¥–æ—Å—Ç–µ–π</h2>
                <p>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∑–∞–¥–∞—á—É</p>
            </div>
            
            <div class="section joys" data-category="3,4">
                <h2>–ü—Ä–æ—Å—Ç—ã–µ –∏ —ç–≥–æ-—Ä–∞–¥–æ—Å—Ç–∏</h2>
                <p>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∑–∞–¥–∞—á–∞</p>
            </div>
        </div>
        
        <div class="controls">
            <button id="showTasksBtn">–í—Å–µ –∑–∞–¥–∞—á–∏</button>
            <button id="addMultipleBtn">–î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á</button>
            <button id="exportTasksBtn">–°–∫–∞—á–∞—Ç—å –∑–∞–¥–∞—á–∏</button>
        </div>
        
        <div class="task-list" id="taskList" style="display: none;">
            <h2>–í—Å–µ –∑–∞–¥–∞—á–∏</h2>
            
            <div class="task-form">
                <textarea id="taskText" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É..."></textarea>
                <select id="taskCategory">
                    <option value="0">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–µ–∞–∫—Ç–∏–≤–Ω–∞)</option>
                    <option value="1">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–ª–∞</option>
                    <option value="2">–°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</option>
                    <option value="5">–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—ã—Ö —Ä–∞–¥–æ—Å—Ç–µ–π</option>
                    <option value="3">–ü—Ä–æ—Å—Ç—ã–µ —Ä–∞–¥–æ—Å—Ç–∏</option>
                    <option value="4">–≠–≥–æ —Ä–∞–¥–æ—Å—Ç–∏</option>
                </select>
                <button id="addTaskBtn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
            </div>
            
            <div class="import-export">
                <label for="importFile" class="file-label">
                    <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á–∏ –∏–∑ —Ñ–∞–π–ª–∞
                </label>
                <input type="file" id="importFile" class="file-input" accept=".json">
            </div>
            
            <div class="tasks" id="tasksContainer">
                <!-- –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
            
            <button id="hideTasksBtn">–°–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫</button>
        </div>
    </div>
    
    <div class="timer-screen" id="timerScreen">
        <div class="timer-content">
            <h2>–í–∞—à–∞ –∑–∞–¥–∞—á–∞:</h2>
            <div class="timer-task" id="timerTaskText"></div>
            <div class="timer-display" id="timerDisplay">15:00</div>
            
            <div class="timer-controls">
                <input type="number" id="timerMinutes" min="1" max="120" value="15">
                <button class="timer-btn" id="startTimerBtn">–°—Ç–∞—Ä—Ç</button>
                <button class="timer-btn" id="pauseTimerBtn">–ü–∞—É–∑–∞</button>
                <button class="timer-btn" id="resetTimerBtn">–°–±—Ä–æ—Å</button>
            </div>
            
            <div class="timer-complete-options" id="timerCompleteOptions">
                <button class="timer-btn" id="completeTaskBtn">–ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                <button class="timer-btn" id="returnTaskBtn">–í–µ—Ä–Ω—É—Ç—å –≤ –∫–æ—Ä–æ–±–æ—á–∫—É</button>
            </div>
            
            <button class="timer-btn" id="closeTimerBtn" style="margin-top: 15px;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="notification" id="notification">
        –í—Ä–µ–º—è –≤—ã—à–ª–æ!
    </div>

    <script>
        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
        let tasks = [];

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å localStorage
        function loadTasks() {
            const tasksJSON = localStorage.getItem('tasks');
            if (tasksJSON) {
                tasks = JSON.parse(tasksJSON);
            } else {
                tasks = [];
            }
            return tasks;
        }

        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function getNextId() {
            let maxId = 0;
            tasks.forEach(task => {
                if (task.id > maxId) maxId = task.id;
            });
            return maxId + 1;
        }

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        let currentTask = null;
        let timerInterval = null;
        let timerTime = 15 * 60; // 15 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        let timerRunning = false;
        let selectedTaskId = null;
        let activeDropdown = null;
        
        // –ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
        let timerStartTime = 0;
        let timerPausedTime = 0;
        let timerAnimationFrame = null;
        let timerWorker = null;

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const sections = document.querySelectorAll('.section');
        const showTasksBtn = document.getElementById('showTasksBtn');
        const addMultipleBtn = document.getElementById('addMultipleBtn');
        const exportTasksBtn = document.getElementById('exportTasksBtn');
        const taskList = document.getElementById('taskList');
        const tasksContainer = document.getElementById('tasksContainer');
        const taskText = document.getElementById('taskText');
        const taskCategory = document.getElementById('taskCategory');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const hideTasksBtn = document.getElementById('hideTasksBtn');
        const timerScreen = document.getElementById('timerScreen');
        const timerTaskText = document.getElementById('timerTaskText');
        const timerDisplay = document.getElementById('timerDisplay');
        const timerMinutes = document.getElementById('timerMinutes');
        const startTimerBtn = document.getElementById('startTimerBtn');
        const pauseTimerBtn = document.getElementById('pauseTimerBtn');
        const resetTimerBtn = document.getElementById('resetTimerBtn');
        const completeTaskBtn = document.getElementById('completeTaskBtn');
        const returnTaskBtn = document.getElementById('returnTaskBtn');
        const closeTimerBtn = document.getElementById('closeTimerBtn');
        const importFile = document.getElementById('importFile');
        const notification = document.getElementById('notification');
        const timerCompleteOptions = document.getElementById('timerCompleteOptions');

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –Ω–æ–º–µ—Ä—É
        function getCategoryName(category) {
            const categories = {
                0: "–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
                1: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ",
                2: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",
                3: "–ü—Ä–æ—Å—Ç—ã–µ —Ä–∞–¥–æ—Å—Ç–∏",
                4: "–≠–≥–æ —Ä–∞–¥–æ—Å—Ç–∏",
                5: "–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–∞–¥–æ—Å—Ç–µ–π"
            };
            return categories[category] || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
        function displayTasks() {
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–¥–∞—á–∏: —Å–Ω–∞—á–∞–ª–∞ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (0), –∑–∞—Ç–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            tasks.sort((a, b) => {
                if (a.category === 0 && b.category !== 0) return -1;
                if (a.category !== 0 && b.category === 0) return 1;
                return a.category - b.category;
            });
            
            tasksContainer.innerHTML = '';
            
            tasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.className = `task category-${task.category} ${task.active ? '' : 'inactive'}`;
                taskElement.dataset.id = task.id;
                
                // –î–ª—è –∑–∞–¥–∞—á –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –ø–∞–ø–∫–∏
                const categoryDisplay = task.category === 0 ? 
                    '<i class="fas fa-folder"></i>' : 
                    getCategoryName(task.category);
                
                taskElement.innerHTML = `
                    <div class="task-content">
                        <div class="task-text">${task.text}</div>
                        <div class="category-selector">
                            <div class="category-badge" data-id="${task.id}">
                                ${categoryDisplay}
                                <i class="fas fa-caret-down"></i>
                            </div>
                            <div class="category-dropdown" id="dropdown-${task.id}">
                                <button class="category-option" data-category="0">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
                                <button class="category-option" data-category="1">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</button>
                                <button class="category-option" data-category="2">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
                                <button class="category-option" data-category="5">–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–∞–¥–æ—Å—Ç–µ–π</button>
                                <button class="category-option" data-category="3">–ü—Ä–æ—Å—Ç—ã–µ —Ä–∞–¥–æ—Å—Ç–∏</button>
                                <button class="category-option" data-category="4">–≠–≥–æ —Ä–∞–¥–æ—Å—Ç–∏</button>
                            </div>
                        </div>
                    </div>
                    <div class="task-controls">
                        <button class="task-control-btn toggle-active-btn" data-id="${task.id}">
                            <i class="fas ${task.active ? 'fa-eye-slash' : 'fa-eye'}"></i>
                        </button>
                        <button class="task-control-btn delete-task-btn" data-id="${task.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                tasksContainer.appendChild(taskElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.category-badge').forEach(badge => {
                badge.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const taskId = parseInt(this.dataset.id);
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–∫—Ä—ã—Ç—ã–π dropdown
                    if (activeDropdown && activeDropdown !== this.nextElementSibling) {
                        activeDropdown.classList.remove('show');
                    }
                    
                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º/–∑–∞–∫—Ä—ã–≤–∞–µ–º dropdown
                    const dropdown = this.nextElementSibling;
                    dropdown.classList.toggle('show');
                    activeDropdown = dropdown;
                });
            });
            
            document.querySelectorAll('.category-option').forEach(option => {
                option.addEventListener('click', function() {
                    const taskId = parseInt(this.closest('.category-selector').querySelector('.category-badge').dataset.id);
                    const newCategory = parseInt(this.dataset.category);
                    changeTaskCategory(taskId, newCategory);
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º dropdown
                    this.closest('.category-dropdown').classList.remove('show');
                    activeDropdown = null;
                });
            });
            
            document.querySelectorAll('.toggle-active-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('.toggle-active-btn').dataset.id);
                    toggleTaskActive(id);
                });
            });
            
            document.querySelectorAll('.delete-task-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('.delete-task-btn').dataset.id);
                    deleteTask(id);
                });
            });
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º dropdown –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (activeDropdown && !e.target.closest('.category-selector')) {
                    activeDropdown.classList.remove('show');
                    activeDropdown = null;
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞—á–∏
        function changeTaskCategory(taskId, newCategory) {
            const taskIndex = tasks.findIndex(t => t.id === taskId);
            if (taskIndex === -1) return;
            
            // –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –±—ã–ª–∞ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞, –∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ–µ
            const updateData = { category: newCategory };
            if (tasks[taskIndex].category === 0 && !tasks[taskIndex].active && newCategory !== 0) {
                updateData.active = true;
            }
            
            tasks[taskIndex] = { ...tasks[taskIndex], ...updateData };
            saveTasks();
            displayTasks();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏
        function toggleTaskActive(taskId) {
            const taskIndex = tasks.findIndex(t => t.id === taskId);
            if (taskIndex === -1) return;
            
            tasks[taskIndex].active = !tasks[taskIndex].active;
            saveTasks();
            displayTasks();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
        function deleteTask(taskId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                saveTasks();
                displayTasks();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–∞–¥–∞—á –≤ —Ñ–∞–π–ª
        function exportTasks() {
            const dataStr = JSON.stringify(tasks, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = '–∫–æ—Ä–æ–±–æ—á–∫–∞-–∑–∞–¥–∞—á–∏.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∑–∞–¥–∞—á –∏–∑ —Ñ–∞–π–ª–∞
        function importTasks(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const importedTasks = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(importedTasks)) {
                        alert('–û—à–∏–±–∫–∞: —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞—Å—Å–∏–≤ –∑–∞–¥–∞—á');
                        return;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–¥–∞—á
                    for (const task of importedTasks) {
                        if (!task.text || typeof task.category === 'undefined') {
                            alert('–û—à–∏–±–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
                            return;
                        }
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                    tasks = importedTasks;
                    saveTasks();
                    alert(`–£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${importedTasks.length} –∑–∞–¥–∞—á`);
                    displayTasks();
                    
                } catch (error) {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: ' + error.message);
                }
            };
            
            reader.readAsText(file);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω–æ–π –∑–∞–¥–∞—á–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getRandomTask(categories) {
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –º–∞—Å—Å–∏–≤ —á–∏—Å–µ–ª
            const categoryArray = categories.split(',').map(Number);
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const filteredTasks = tasks.filter(task => 
                categoryArray.includes(task.category) && task.active
            );
            
            if (filteredTasks.length === 0) {
                alert('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏!');
                return null;
            }
            
            const randomIndex = Math.floor(Math.random() * filteredTasks.length);
            return filteredTasks[randomIndex];
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
        function showTimer(task) {
            currentTask = task;
            timerTaskText.textContent = task.text;
            timerTime = parseInt(timerMinutes.value) * 60;
            updateTimerDisplay();
            timerScreen.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ–ø—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–º
            timerCompleteOptions.style.display = 'none';
            document.querySelector('.timer-controls').style.display = 'flex';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Ç–∞–π–º–µ—Ä–∞
        function hideTimer() {
            timerScreen.style.display = 'none';
            document.body.style.overflow = 'auto'; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
            stopTimer(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
        function updateTimerDisplay() {
            const minutes = Math.floor(timerTime / 60);
            const seconds = timerTime % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification() {
            notification.textContent = "–í—Ä–µ–º—è –≤—ã—à–ª–æ!";
            notification.style.display = 'block';
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if (navigator.vibrate) {
                navigator.vibrate([500, 300, 500]);
            }
            
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification("–í—Ä–µ–º—è –≤—ã—à–ª–æ!");
            } else if ("Notification" in window && Notification.permission !== "denied") {
                Notification.requestPermission().then(permission => {
                    if (permission === "granted") {
                        new Notification("–í—Ä–µ–º—è –≤—ã—à–ª–æ!");
                    }
                });
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –ù–û–í–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –¢–ê–ô–ú–ï–†–ê (—Ç–æ—á–Ω—ã–π –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ —Ñ–æ–Ω–µ)

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            if (timerRunning) return;
            
            timerRunning = true;
            timerStartTime = Date.now() - (timerPausedTime * 1000);
            timerPausedTime = 0;
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º Web Worker –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ–Ω–µ
            if (typeof(Worker) !== "undefined") {
                if (timerWorker === null) {
                    timerWorker = new Worker(URL.createObjectURL(new Blob([`
                        let interval;
                        self.onmessage = function(e) {
                            if (e.data === 'start') {
                                interval = setInterval(() => {
                                    self.postMessage('tick');
                                }, 1000);
                            } else if (e.data === 'stop') {
                                clearInterval(interval);
                            }
                        };
                    `], {type: 'application/javascript'})));
                    
                    timerWorker.onmessage = function(e) {
                        if (e.data === 'tick') {
                            const elapsed = Math.floor((Date.now() - timerStartTime) / 1000);
                            timerTime = Math.max(0, parseInt(timerMinutes.value) * 60 - elapsed);
                            updateTimerDisplay();
                            
                            if (timerTime <= 0) {
                                stopTimer();
                                showNotification();
                                
                                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
                                timerCompleteOptions.style.display = 'flex';
                                document.querySelector('.timer-controls').style.display = 'none';
                            }
                        }
                    };
                }
                timerWorker.postMessage('start');
            } else {
                // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Web Workers
                timerInterval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - timerStartTime) / 1000);
                    timerTime = Math.max(0, parseInt(timerMinutes.value) * 60 - elapsed);
                    updateTimerDisplay();
                    
                    if (timerTime <= 0) {
                        stopTimer();
                        showNotification();
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–ø—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
                        timerCompleteOptions.style.display = 'flex';
                        document.querySelector('.timer-controls').style.display = 'none';
                    }
                }, 1000);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—É–∑—ã —Ç–∞–π–º–µ—Ä–∞
        function pauseTimer() {
            if (!timerRunning) return;
            
            stopTimer();
            timerPausedTime = parseInt(timerMinutes.value) * 60 - timerTime;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞–π–º–µ—Ä–∞
        function stopTimer() {
            timerRunning = false;
            
            if (timerWorker) {
                timerWorker.postMessage('stop');
            } else {
                clearInterval(timerInterval);
            }
            
            if (timerAnimationFrame) {
                cancelAnimationFrame(timerAnimationFrame);
                timerAnimationFrame = null;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ç–∞–π–º–µ—Ä–∞
        function resetTimer() {
            stopTimer();
            timerTime = parseInt(timerMinutes.value) * 60;
            timerPausedTime = 0;
            updateTimerDisplay();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        sections.forEach(section => {
            section.addEventListener('click', () => {
                const categories = section.dataset.category;
                const task = getRandomTask(categories);
                if (task) showTimer(task);
            });
        });

        showTasksBtn.addEventListener('click', () => {
            taskList.style.display = 'block';
            displayTasks();
        });

        hideTasksBtn.addEventListener('click', () => {
            taskList.style.display = 'none';
        });

        addTaskBtn.addEventListener('click', () => {
            const text = taskText.value.trim();
            const category = parseInt(taskCategory.value);
            
            if (text) {
                // –ó–∞–¥–∞—á–∏ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã
                const active = category !== 0;
                
                tasks.push({
                    id: getNextId(),
                    text,
                    category,
                    completed: false,
                    active
                });
                
                saveTasks();
                taskText.value = '';
                displayTasks();
            }
        });

        addMultipleBtn.addEventListener('click', () => {
            const tasksText = prompt('–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á–∏, —Ä–∞–∑–¥–µ–ª—è—è –∏—Ö –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏:');
            if (tasksText) {
                const tasksArray = tasksText.split('\n').filter(task => task.trim());
                
                if (confirm(`–î–æ–±–∞–≤–∏—Ç—å ${tasksArray.length} –∑–∞–¥–∞—á?`)) {
                    tasksArray.forEach(task => {
                        tasks.push({
                            id: getNextId(),
                            text: task.trim(),
                            category: 0, // –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                            completed: false,
                            active: true // –¢–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                        });
                    });
                    
                    saveTasks();
                    displayTasks();
                }
            }
        });

        exportTasksBtn.addEventListener('click', exportTasks);

        importFile.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                importTasks(e.target.files[0]);
                e.target.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ input
            }
        });

        startTimerBtn.addEventListener('click', startTimer);
        pauseTimerBtn.addEventListener('click', pauseTimer);
        resetTimerBtn.addEventListener('click', resetTimer);

        completeTaskBtn.addEventListener('click', () => {
            if (currentTask) {
                // –ü–æ–º–µ—á–∞–µ–º –∑–∞–¥–∞—á—É –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—É—é –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è
                const taskIndex = tasks.findIndex(t => t.id === currentTask.id);
                if (taskIndex !== -1) {
                    tasks[taskIndex].completed = true;
                    tasks[taskIndex].active = false;
                    saveTasks();
                }
                
                stopTimer();
                hideTimer();
                displayTasks();
            }
        });

        returnTaskBtn.addEventListener('click', () => {
            stopTimer();
            hideTimer();
        });

        closeTimerBtn.addEventListener('click', () => {
            stopTimer();
            hideTimer();
        });

        timerMinutes.addEventListener('change', () => {
            if (!timerRunning) {
                timerTime = parseInt(timerMinutes.value) * 60;
                updateTimerDisplay();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            loadTasks();
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            if ("Notification" in window && Notification.permission === "default") {
                Notification.requestPermission();
            }
        });
    </script>
</body>
</html>
